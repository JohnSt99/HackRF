# HackRF

The goal of this project was understanding the capabilities of HackRF, signal analysis and reverse engineering, execution of replay attacks, jamming, brute force attacks (using De Bruijn theory), rolling code attacks, and of course, opening my garage door using a PC. The garage door used a 12 DIP-switch technology which was fully reverse engineered, allowing for signal reconstruction in order to perform a successful replay attack. Given the opportunity, I also experimented with NFC tags as well as credit card readers.

------------------------------------------------------------------------------------------------------------------------------------------------------------


- Τι είναι το HackRF Περιεχόμενα
   - Παραδείγματα επιθέσεων
      - Brute Force Attack
      - Replay Attacks
      - Rolling code
      - Jamming Attacks
      - Attack on Rolling code
      - Λογισμικό που χρησιμοποιήσαμε
   - Διεξαγωγή επίθεσης
- Τι είναι το RFID (radio frequency identification)
   - Πειράματα επάνω στις ετικέτες (NFC tags)
      - Με χρήση Arduino
   - Πειράματα επάνω στις τραπεζικές κάρτες
- Βιβλιογραφία


# Τι είναι το HackRF

Το HackRF One είναι ένας ραδιοφωνικός πομποδέκτης ραδιοσυχνοτήτων (SDR) με
ευρεία ζώνη που δημιουργήθηκε και κατασκευάστηκε από την Great Scott Gadgets. Ο
κώδικας του είναι ανοιχτής φύσης για το λογισμικό αλλά και του υλικό του. Το HackRF
One έχει τη δυνατότητα λήψης και μετάδοσης σε εύρος συχνοτήτων από 1MHz έως
6GHz.

### Παραδείγματα επιθέσεων

Όπως είναι λογικό, ο κάθε ένας που έχει τα απαραίτητα εργαλεία και την γνώση, μπορεί
να καταγράψει και να ανάλυση όλα τα ραδιοσήματα που μεταδίδονται στον περίγυρο
του. Αυτό μας δίνει την απορία, τι θα μπορούσε ένας κακόβουλος χρήστης να θα
μπορούσε να κάνει ενάντιων μας. Παρακάτω θα αναλύσουμε μερικά παραδείγματα από
τον αληθινό κόσμο.

#### Brute Force Attack

Σε μια τέτοια επίθεση ο επιτιθέμενος δεν χεριάζετε να γνωρίζει τίποτα για να επιτεθεί.
Φυσικά όσα περισσότερα πράγματα γνωρίζει, τόσο περισσότεροι πιθανότητα έχει για
να επιτυχή τον στόχο του, (πχ συχνότητα, μήκος κλειδιού). Ο επιτιθέμενος εδώ
προσπαθεί να μαντέψει τον κωδικό με τυχαίο τρόπο δοκιμάζοντας όλους τους πιθανούς
συνδυασμούς. Φυσικά αυτό δεν είναι κάτι τόσο αποτελεσματικό, καθώς θα τραβήξει
πολλά βλέμματα καίοντας με μια κεραία διπλά σε μια ξένη γκαραζόπορτα. Υπάρχουν
τεχνικές που μειώνουν αυτόν τον χρόνο ραγδαία (όπως η ακολουθία De Bruijn ).

#### Replay Attacks

Ένα πολύ βασικό ερώτημα είναι, « θα μπορούσε κάποιος να καταγράψει το σήμα που
ξεκλειδώνει την γκαραζόπορτα σας και να το αναμεταδώσει όποτε επιθυμεί εκείνος?».
Η απάντηση είναι «Ναι» μπορεί να το κάνει. Όμως τα πράγματα δεν είναι τόσο απλά.
Για αρχή θα πρέπει ο δράστης να γνωρίζει την στυγνότητα που μεταδίδει το κλειδί της
γκαραζόπορτας (Υπάρχουν standards που οι κατασκευαστές ακολουθούν). Υστέρα θα
πρέπει να βρίσκεται σε απόσταση που μπορεί να καταγράψει το σήμα σας, καθώς και
να είναι σε ετοιμότητα να το καταγράψει μόλις εσείς το πατήσετε. Θεωρώντας ότι όλα
τα παρακάτω έχουν γίνει με επιτυχία και ο δράστης έχει κατεργασμένο το σήμα σας,
ακόμη και τότε δεν μπορεί απλός να το μεταδώσει και να λειτουργήσει όπως το κλειδί


σας. Σε αυτήν την φάση ο δράστης θα πρέπει να ανάλυση το σήμα, φιλτράροντας τον
θόρυβο που προκύπτει από όλα τα υπόλοιπα σήματα , να ενδυνάμωση το σήμα, και
άλλες επεξεργασίες που τείχος χρειαστούν. Εάν υποθέσουμε πως όλα πήγαν σωστά
είναι η στιγμή που ο επιτιθέμενος θα μπορεί να ανοιγοκλείνει την γκαραζόπορτα σας
όποτε επιθυμεί.

#### Rolling code

Οι κυλιόμενοι κωδικοί εφευρέθηκαν με σκοπό την αποτρέψει των Replay Attack. Ένας
κυλιόμενος κωδικός είναι μια κρυφή συνάρτηση που εμπεριέχετε στους πομπούς και
δέκτες (πχ σε μια γκαραζόπορτα και στο ασύρματο κλειδί του), και δημιουργούν νέους
κωδικούς κάθε φορά που ένας χρησιμοποιείτε. Φανταστείτε πως κάθε φορά που πατάτε
το κλειδί για να ξεκλειδώσετε την γκαραζόπορτα σας, εσωτερικά το κλειδί σας
δημιουργεί μέσω της συναρτήσεις το νέο κλειδί και το αποστέλλει. Από την πλευρά
του η γκαραζόπορτα δημιουργεί τα επόμενα κλειδιά και τα αντίστοιχοι με αυτό που
στείλατε. Όταν ένα κλειδί χρησιμοποιηθεί, αυτό και όλα τα προηγούμενα διαγράφονται
από την λίστα που δημιουργείτε μέσω της συνάρτησης. Έτσι όταν εσείς ανοίξετε την
γκαραζόπορτα σας και ο επιτιθέμενος καταγράψει το σήμα που μεταδώσατε, δεν θα
καταφέρει με κανέναν τρόπο να ανοίξει την γκαραζόπορτα με αυτό το κλειδί, δεν έχει
την δυνατότητα ούτε να βρει την συνάρτηση μέσω του κλειδιού που κατέγραψε.

#### Jamming Attacks

Σε μια τέτοια επίθεση ο επιτιθέμενος δεν έχει (απαραίτητα) τον στόχο του να υποκλέψει
κάτι από εμάς, αλλά στο να κάνει να μην μπορουμε ούτε εμείς να χρησιμοποιήσουμε
αυτό που θέλουμε. Εδώ ο επιτιθέμενος μεταδίδει με πολύ μεγάλη ισχύ στην συχνότητα
που μεταδίδουμε και εμείς με το κλειδί (και στις κοντινές γύρο συχνότητες), με
αποτέλεσμα ο δέκτης να μην καταφέρνει να διαβάσει το καθαρό σήμα που μεταδίδουμε
εμείς.

#### Attack on Rolling code

Όλα τα νέα συστήματα που χρησιμοποιούν ραδιοσυχνότητες ως βασική επικοινωνία
μεταξύ τους, πλέον χρησιμοποιούν κυλιόμενους κωδικούς. Αυτό είχε ως αποτέλεσμα
την εμφάνιση ενός νέου τρόπου επιθέσεις για την υποκλέψει του κλειδιού μετάδοσης.
Η επίθεση λειτουργεί ως εξής, ο επιτιθέμενος παρεμποδίζει (jamming) το σήμα που
στέλνουμε εμείς, ενώ ταυτόχρονα το καταγραφεί, στην συνέχεια επειδή θεωρούμε πως
δεν έπιασε το σήμα αναμεταδίδουμε, και ο επιτιθέμενος καταγραφεί και το δεύτερο


κλειδί. Ταυτόχρονα με την καταγραφή του δευτέρου κλειδιού μεταδίδει το πρώτο
κλειδί που κατέγραψε, με αποτέλεσμα ο δέκτης να το λάβει και να ξεκλειδώσει. Τώρα
ο επιτιθέμενος έχει καταγεγραμμένο το ακριβώς επόμενο κλειδί που ξεκλειδώνει τον
δεκτή και εμείς δεν το γνωρίζουμε, καθώς πιστεύαμε πως απλός δεν έπιασε το σήμα.

- Λυση

Μια λύση για το πρόβλημα αυτό θα ήταν εκτός των κυλιόμενων κωδίκων να υπάρχει
και χρονικό όριο χρήσης του κάθε κωδικού.

#### Λογισμικό που χρησιμοποιήσαμε

Προκειμένου να αξιοποιήσουμε τις δυνατότητες τους hackrf χρησιμοποιήσαμε 3
προγράμματα στo windows λειτουργικό. Αρχικά κατεβάσαμε το SDR-SHARP της
AIRSPY το οποίο θεωρούμε πως είναι το καταλληλότερο πρόγραμμα προκειμένου να
βρούμε την συχνότητα στην οποία υπάρχει η εκπομπή του σήματος που ψάχνουμε. Στο
πάνω κομμάτι του προγράμματος εμφανίζεται μία μύτη όταν παρατηρείται ένα έντονο
σήμα, επομένως γίνεται εμφανές σε ποια συχνότητα ακριβώς εκπέμπει. Στο μπλέ
κομμάτι από κάτω εμφανίζεται ένα λευκό σημάδι το οποίο σημαίνει ότι εκπέμπεται
πληροφορία. Σε περίπτωση που υπάρχει μύτη στο πάνω κομμάτι θεωρούμε πως είναι
απλά θόρυβος.

![image](https://user-images.githubusercontent.com/17860067/129609046-972d9cee-67d4-4c00-8e5a-fe42f28d4819.png)

Για περαιτέρω ανάλυση υπάρχουν και διάφορες ρυθμίσεις όμως εμείς δεν χρειάστηκε
να πειράξουμε κάποια ρύθμιση για να βρούμε την συχνότητα του σήματος μας.

![image](https://user-images.githubusercontent.com/17860067/129607906-6e877fab-a06c-43e8-b787-a341baae5730.png)

Ενδεικτικά παρακάτω εμφανίζεται μία χαμηλή συχνότητα που περιέχει πολύ θόρυβο.

![image](https://user-images.githubusercontent.com/17860067/129607920-871dfa0e-ebe3-4ea6-abba-5d55fcaeae69.png)

Το δεύτερο πρόγραμμα που χρησιμοποιήσαμε είναι το Universal Radio Hacker. Από
μόνο του, μπορεί να χρησιμοποιηθεί αποκλειστικά προκειμένου να πραγματοποιηθεί
μία ανάλυση και επίθεση όμως θεωρήθηκε πως ο συνδυασμός προγραμμάτων είναι πιο
σωστός για ευρύτερη κατανόηση.

![image](https://user-images.githubusercontent.com/17860067/129607933-bf4f7b55-3742-498d-a3f9-7984fca9dd6b.png)


Πηγαίνοντας στο tab file μπορούμε να δούμε τις λειτουργίες του. Μπορούμε να
δημιουργήσουμε ένα project, να ανοίξουμε ένα αρχείο/φάκελο αλλά και να import
αρχείων. Ωστόσο οι σημαντικές λειτουργίες είναι το Spectrum Analyzer και το record
analyzer.
Πηγαίνοντας στο tab file μπορούμε να δούμε τις λειτουργίες του. Μπορούμε να
δημιουργήσουμε ένα project, να ανοίξουμε ένα αρχείο/φάκελο αλλά και να import
αρχείων. Ωστόσο οι σημαντικές λειτουργίες είναι το Spectrum Analyzer και το record
analyzer.

![image](https://user-images.githubusercontent.com/17860067/129607942-21f60cfc-b1a9-465f-b43d-c2e5671599f5.png)

Στο Spectrum Analyzer πραγματοποιούμε ότι και στο airspy δηλαδή βρίσκουμε την
συχνότητα του σήματος που μας ενδιαφέρει.

![image](https://user-images.githubusercontent.com/17860067/129607952-69cd645e-c082-4644-a529-bbde30dfa0cd.png)

Παρακάτω φαίνεται το spectrum analyzer ενώ χρησιμοποιεί το hackrf.

![image](https://user-images.githubusercontent.com/17860067/129607965-44d942f8-0f68-4528-a230-5a7542327c1e.png)

Στο record signal εισάγουμε την συχνότητα στην οποία βρήκαμε προηγουμένως το
επιθυμητό σήμα και ορίζουμε τις παραμέτρους που επιθυμούμε.

![image](https://user-images.githubusercontent.com/17860067/129607976-1e3fb564-ddc1-4d6e-9e79-cd6873d26979.png)

Αφού κάναμε capture το σήμα που έπιθυμούμε μπορούμε να πραγματοποιήσουμε
ανάλυση, να χρησιμοποιήσουμε φίλτρα και γενικά να το αλλάξουμε όπως επιθυμούμε.

![image](https://user-images.githubusercontent.com/17860067/129607988-9274bebb-bc25-4eb8-aa83-5278cdb4ab28.png)

Επλιπλέον, υπάρχει η δυνατότητα σύγκρισης 2 σημάτων η οποία αποδείχτηκε άκρως
σημαντική για την υλοποίηση της επίθεσης μας.

![image](https://user-images.githubusercontent.com/17860067/129607996-cb1b0fde-dc05-45ac-bcf1-c77fc930e3ef.png)

Τέλος, υπάρχει το audacity το οποίο αν και πρόγραμμα μουσικής βοηθάει στην
κατανόηση των σημάτων τα οποία κάναμε capture.

![image](https://user-images.githubusercontent.com/17860067/129608012-10a85dec-bf03-4e90-8a58-42d18f2cab0d.png)

### Διεξαγωγή επίθεσης

Το test-case που εξετάσαμε αφορά μια γκαραζόπορτα που χρησιμοποιεί δύο ασύρματα
κοντρόλ με τεχνολογία dip switches.

![image](https://user-images.githubusercontent.com/17860067/129608030-94b0dcd0-fb55-45d9-84c1-0adfba88a646.png)
![image](https://user-images.githubusercontent.com/17860067/129608054-27f93dd0-c59d-448d-8c5d-7eb126439b35.png)

Αυτοί οι διακόπτες καθορίζουν το σήμα που εκπέμπεται για το ξεκλείδωμα της πόρτας.
Μπορούμε να εντοπίσουμε τη συχνότητα που εκπέμπουν αυτά τα remotes μέσω του
προγράμματος SDR#.

![image](https://user-images.githubusercontent.com/17860067/129608074-95642491-7fe5-424d-a055-3ab9364f79c1.png)

Από την παραπάνω εικόνα συμπεραίνουμε ότι η συχνότητα μετάδοσης των κοντρόλ
είναι τα 27.015Mhz.
Κάνουμε capture σήμα από κάθε κοντρόλ μέσω του Universal Radio Hacker με Sample
Rate - 2ΜHz και Bandwidth – 2MHz και παρατηρούμε ότι είναι το ίδιο σε κάθε capture
και μεταξύ των κοντρόλ, συνεπώς δεν χρησιμοποιεί κάποιο μηχανισμό rolling code και
έχει στατικό κωδικό για κάθε χρήση. Τα 12 DIP switches επιτρέπουν τη δημιουργία
212 κωδικών, δηλαδή 4096. Για σύγκριση, ένας κωδικός 2 ψηφίων (αλφαριθμητικά και
σύμβολα) είναι πιο ισχυρός. Με αλφαριθμητικά (26 μικρά, 26 κεφαλαία και 10
αριθμοί) και σύμβολα του πληκτρολογίου (τα 10 που αντιστοιχούν στους αριθμούς 0-
9), υπάρχουν 72 χαρακτήρες διαθέσιμοι για κάθε ψηφίο του κωδικού. Ένας διψήφιος
κωδικός λοιπόν θα έχει 722 πιθανούς συνδυασμούς, δηλαδή 5184.

![image](https://user-images.githubusercontent.com/17860067/129608084-7c636232-dc5b-4728-8a3d-342bd7847c50.png)

Η μεγάλη συνεχής περίοδος αποτελεί ένα preamble, δηλαδή ένα introduction του
controller που δηλώνει την ύπαρξη του. Είναι το αντίστοιχο με το header των πακέτων
αλλά για τα σήματα.
Το παραπάνω σήμα είναι σε ASK modulation, το οποίο σημαίνει ότι γίνεται μετάδοση
σήματος όποτε τις στιγμές που εμφανίζεται σήμα αποστέλλονται δεδομένα

![image](https://user-images.githubusercontent.com/17860067/129608099-1ea0ceba-849d-4f96-8c69-698d04917ff6.png)

Από τα σήματα μεταξύ των preambles, βλέπουμε δύο είδη σημάτων. Τα σήματα με το
μεγαλύτερο μήκος και αυτά με μικρότερο: ![image](https://user-images.githubusercontent.com/17860067/129608129-e6186be4-0f2d-4caf-9d92-7cf5c90d960b.png)
, ![image](https://user-images.githubusercontent.com/17860067/129608140-47494110-b77c-46c6-9c53-e2429285a82e.png)
. Τα σήματα αυτά είναι τα
bits 11 και το bit 1 όπως στην εικόνα παραπάνω. Το σήμα έχει τη μορφή 11 11 11 11
1 1 1 1 1 11 1 1.
Αν αντιστοιχήσουμε τα δύο σήματα με τα σύμβολα 0 και 1 αντίστοιχα για τα DIP
switches σχηματίζουμε τον κωδικό 0 0 0 0 1 1 1 1 1 0 1 1. Τα πρώτα δέκα ψηφία του
κωδικού ταιριάζουν με το κοντρόλ. Το γεγονός ότι τα δύο κοντρόλ έχουν διαφορετικό
αριθμό DIP switches (10 και 12 αντίστοιχα) υποδεικνύει ότι ο κωδικός που
χρησιμοποιείται είναι μάλλον 10 ψηφίων.
Με την επιλογή autodetect parameters του Universal Radio Hacker το σήμα
αποκωδικοποιείται με τον ακόλουθο τρόπο:


##### 11111111111111111111111111111111111111111111

##### 011101110111011101100100100100110011101100100

##### 11111111111111111111111111111111111111111111

##### 011101110111011101 _ 001001001001 _ 0011101 _ 00100

##### 11111111111111111111111111111111111111111111

##### 011101110111011101 _ 001001001001 _ 0011101 _001(00)

Παρατηρούμε ότι παρά το γεγονός ότι το σήμα είναι το ίδιο κάθε επανάληψη κατά την
πρώτη αποκωδικοποίηση υπάρχει ένα επιπλέον bit.
Μετά από πειραματισμό με τις παραμέτρους καταλήγουμε στις ακόλουθες
παραμέτρους για ένα σήμα παρατεταμένου πατήματος. Εκτός από τις παραμέτρους
εφαρμόζουμε τα φίλτρα DC Correction και Moving Average:

Ο πειραματισμός με τις παραπάνω τιμές είχε ως αποτέλεσμα από μια κωδικοποίηση
όπως η εικόνα στα αριστερά να καταφέρουμε αποκωδικοποίηση όπως η εικόνα στα
δεξιά (οι πράσινες γραμμές είναι οι γραμμές που είναι πανομοιότυπες με την
επιλεγμένη:

![image](https://user-images.githubusercontent.com/17860067/129608384-7e8d8d94-3cfc-4bb6-bd7c-693765db0913.png)
![image](https://user-images.githubusercontent.com/17860067/129608388-3fcbb5b4-0ce4-4edb-9370-e4a1b628a89e.png)

Παρά τις προσπάθειες μας η επίθεση επανάληψης δεν λειτούργησε.
Πραγματοποιήσαμε εκ νέου capture με Sample Rate 4Mhz και Bandwidth 2Mhz,
καθώς σύμφωνα με το θεώρημα του Nyquist το sample rate πρέπει να είναι το διπλάσιο
του bandwidth.

![image](https://user-images.githubusercontent.com/17860067/129608395-e1d8aee3-aaa4-456d-854b-e207b01c3c5c.png)

Το samples/symbol που καταλήξαμε ήταν 4000 εφόσον ένα σύμβολο θέσης 1 είχε
περίπου 4000 samples μήκος όπως φαίνεται παρακάτω. Παρατηρούμε επίσης ότι το
σύμβολο του DIP switch σε θέση 0 έχει μήκος περίπου το διπλάσιο (8000 samples). Το
error tolerance που χρησιμοποιήσαμε ήταν 2:

![image](https://user-images.githubusercontent.com/17860067/129608402-dd29fc8a-7324-43e1-b202-de2a1f2b683d.png)

Το γεγονός ότι κάθε επανάληψη του ίδιου σήματος κωδικοποιείται με τον ίδιο τρόπο
υποδεικνύει πως οι παράμετροι είναι σωστοί.
Σε αυτό το σημείο, οφείλουμε να αναφέρουμε πως με μία αναζήτηση μόνο της
συχνότητας του κοντρόλ βρίσκουμε αμέσως ένα ίδιο με το κοντρόλ για την πόρτα:

![image](https://user-images.githubusercontent.com/17860067/129608412-c0c7a33b-204d-4dd7-a19f-d651de51d3e0.png)

Ο επιτιθέμενος, θα μπορούσε να αγοράσει το κοντρόλ και να θέσει τα DIP switches
στις θέσεις 0000111110 σύμφωνα με το σήμα και να ανοίξει την πόρτα.
Παρ’ αυτά, δεν σταματήσαμε σε αυτό το σημείο. Προσπαθώντας να κάνουμε replay το
σήμα αποτυχημένα, γνωρίσαμε το Generator tab του Universal Radio Hacker, από το
οποίο μπορεί κανείς να δημιουργήσει ένα νέο σήμα με τις ίδιες παραμέτρους με το
αρχικό. Ο τρόπος με τον οποίο γίνεται αυτό, είναι η εύρεση των κατάλληλων
παραμέτρων, ώστε το 3ο και 4ο panel που είναι αντίστοιχα το generated σήμα και αυτό
που έχουμε καταγράψει να είναι όσο το δυνατόν πανομοιότυπα. Η δυνατότητα του


Universal Radio Hacker να βρει αυτόματα τις παραμέτρους βοηθάει πολύ στη
διαδικασία.

![image](https://user-images.githubusercontent.com/17860067/129608431-0a06796b-aa17-4a87-b77a-476030e89714.png)

Κάνοντας transmit το σήμα που δημιουργήθηκε από αυτή τη διαδικασία η πόρτα του
γκαράζ άνοιξε επιτυχώς.
Τα συστήματα για τις πόρτες αυτές χρησιμοποιούν συχνά τεχνολογία bit shifting για
να διαβάζουν το σήμα. Αυτό σημαίνει ότι σε περίπτωση που ο κωδικός είναι 5 bit, και
ο επιτιθέμενος μεταδώσει σήμα 0011100, το receiver θα διαβάζει τα πρώτα 5 bit
(00111), και στη συνέχεια θα «πετάξει» το πρώτο bit, και θα κάνει append στο τέλος
του κωδικού το επόμενο, διαβάζοντας τον κωδικό 01110, και έπειτα 11100 κ.ο.κ.
έναντι της αναμενόμενης συμπεριφοράς να διαβάζει τα πρώτα 5 bit, έπειτα να τα πετάει
και να διαβάζει τα επόμενα 5.
Γνωρίζοντας τα παραπάνω, μπορούμε να επικαλύψουμε τους κωδικούς και να
μειώσουμε το μήκος μίας επίθεσης brute force κατά πολύ. Όλοι οι κωδικοί 12 ψηφίων
είναι 4096. Συνεπώς το συνολικό μήκος όλων των συνδυασμών με wait periods
ανάμεσα όπως στο σήμα μας θα ήταν 12*2*4096=98304bits. Βγάζοντας τα wait
periods και εφαρμόζοντας overlapping μπορούμε να μειώσουμε αυτό το keyspace
δραματικά. Με τη θεωρία του μαθηματικού De Bruijn μπορούμε να επικαλύψουμε
όλους τους 4096 κωδικούς αποτελεσματικά, ώστε να χωρέσουν σε μόλις 4107 bit μέσω
του [http://www.hakank.org/comb/debruijn.cgi,](http://www.hakank.org/comb/debruijn.cgi,) για k=2 (τα σύμβολα 1 και 0) και n=12 (το
μήκος κάθε κλειδιού):

![image](https://user-images.githubusercontent.com/17860067/129608447-3c3b3e91-a65b-4b00-940c-ddb82fe8b642.png)

Με αυτόν τον τρόπο μειώνουμε το keyspace στο 4.178% του αρχικού. Στα παραπάνω
bits, εάν εκπέμπαμε 12 bits κάθε φορά ολισθαίνοντας κατά 1 προς τα δεξιά, θα
εκπέμπαμε όλα τα δυνατά κλειδιά για μια πόρτα με 12 DIP switches. Επιπλέον, στα
παραπάνω bits εμπεριέχονται όλα τα κλειδιά μήκους 1-11 εκτός από αυτά μήκους 12
ψηφίων, κάνοντας την επίθεση ακόμα πιο αποτελεσματική σε περισσότερες
εγκαταστάσεις ή συσκευές.


## Τι είναι το RFID (radio frequency identification)

Τα συστήματα RFID απαρτίζονται από δύο κύρια μέρη. Το πρώτο είναι οι πομποδέκτες
(transponders) που συχνά αναφέρονται και ως ετικέτες RFID (RFID tags). Οι ετικέτες
RFID είναι μικρά chips που αποτελούνται από ένα ολοκληρωμένο κύκλωμα, το οποίο
περιλαμβάνει μνήμη ώστε να αποθηκεύει δεδομένα, και μία κεραία. Το δεύτερο μέρος
είναι οι αναγνώστες ή αισθητήρες (readers), οι οποίοι ανακτούν τα δεδομένα από τις
ετικέτες RFID. Οι αναγνώστες RFΙD έχουν ενσωματωμένα μια κεραία και μια μονάδα
ελέγχου.

Οι ετικέτες
Οι ετικέτες RFID κατηγοριοποιούνται σε τρεις τύπους ανάλογα με τον τρόπο
επικοινωνίας Ένα ολοκληρωμένο κύκλωμα στις ετικέτες RFID μπορεί να περιέχει
μνήμη μόνο για

- ανάγνωση
- ανάγνωση και εγγραφή
- εγγραφή μιας και ανάγνωση.

Τα δεδομένα
Τα δεδομένα που αποθηκεύονται στις ετικέτες αποτελούνται από ένα μοναδικό
αναγνωριστικό και μπορούν, επίσης, να περιλαμβάνουν ένα λειτουργικό σύστημα, μία
αποθήκη δεδομένων και έναν ηλεκτρονικό κώδικα προϊόντων. Το μέγεθος των
δεδομένων, που μια ετικέτα RFID έχει την δυνατότητα να αποθηκεύσει, καθορίζεται
από τον εκάστοτε προμηθευτή.
Οι αναγνώστες
Οι αναγνώστες RFID αποτελούνται από μία κεραία, η οποία αναλαμβάνει την
επικοινωνία μέσω ραδιοσυχνοτήτων με τις ετικέτες. Καθώς και μία μονάδα ελέγχου,
για καθορισμό των διάφορων ενεργειών (αποστολή/ λήψη σημάτων, ανάγνωση/
εγγραφή ετικετών κ.ά.).


### Πειράματα επάνω στις ετικέτες (NFC tags)

Για την εκτέλεση των πειραμάτων μας χρησιμοποιήσαμε ένα Arduino uno και έναν rfid
reader (RC522), καθώς και το κινητό μας τηλέφωνο που υποστηρίζει την τεχνολογία
nfc. Το λογισμικό που χρησιμοποιήσαμε είναι το Arduino ide και το NFC Tools.
Επιπλέον τις ετικέτες που χρησιμοποιήθηκαν ήταν ανάγνωσης και εγγραφής.
Αφού έχουμε εγκαταστήσει την εφαρμογή NFC Tools στο κινητό μας τηλέφωνο,
μπορουμε πολύ ευκολά πλησιάζοντας την ετικέτα στο κινητό να σκανάρουμε και να
διαβάσουμε την πληροφορία που έχει, όπως φαίνεται παρακάτω.

Αναλύοντας το περιεχόμενο της ετικέτας μπορουμε να διακρίνουμε πως έχει ένα serial
number, τι τεχνολογίες χρησιμοποιεί (NfcA, MifareClassic,Ndef), το μέγεθος του, τα
δεδομένα που έχει αποθηκευμένα και τον τύπο της ετικέτας.
Εφόσον η ετικέτα που κατέχουμε έχει και την δυνατότητα εγγραφής, επιλέγουμε να
κάνουμε μια εγγραφή στην ετικέτα. Εδώ μας δίνετε μια πληθώρα γκάμα από επιλογές
που μπορουμε να κάνουμε. Εμείς διαλέξαμε να προσθέσουμε ένα κείμενο “θέλουμε 10
για πτυχίο” και ένα url “dsunipi.com”, περάσαμε ξανά την ετικέτα και αυτόματος
έγραψε ότι πληροφορία είχαμε στην ετικέτα.

![image](https://user-images.githubusercontent.com/17860067/129608533-3bb78630-d61a-4e1e-be52-240ff3f66348.png)
![image](https://user-images.githubusercontent.com/17860067/129608535-7adee27c-b677-4e35-ae55-2005fe9536fe.png)
![image](https://user-images.githubusercontent.com/17860067/129608548-d6f17eb1-0326-4fb6-844c-e31bbe2c126a.png)
![image](https://user-images.githubusercontent.com/17860067/129608541-5ca24677-e6fe-4724-9b49-6633351d2560.png)


Ενώ η δυνατότητα υπάρχει στην τεχνολογία, λόγο μη επαρκούς λογισμικού δεν
μπορέσαμε να αντιγράψουμε είδη υπάρχον κλειδωμένες ετικέτες, όπως είναι τα
εισιτήρια του ΟΑΣΑ και χρεωστικές - πιστωτικές κάρτες.

#### Με χρήση Arduino

Για την ανάλυση των ετικετών μέσο του Arduino χρησιμοποιήσαμε το “RC522” που
φαίνεται στην εικόνα παρακάτω και την βιβλιοθήκη “MFRC522”.

![image](https://user-images.githubusercontent.com/17860067/129608604-4d521865-54fd-44ea-b4ed-ba619018ea45.png)
![image](https://user-images.githubusercontent.com/17860067/129608617-faca8989-1112-4539-8ac9-afc3ecce8c05.png)

Μέσο του Serial Monitor διαβάζαμε τις
πληροφορίες ενός εισιτήριου ΟΑΣΑ και μιας
ληγμένης χρεωστικής κάρτας. Δεν καταφέραμε να
το αναλύσουμε σε μεγαλύτερο επίπεδο, λόγο
περιορισμών νομικής περίστασης.

Εισιτήριο

![image](https://user-images.githubusercontent.com/17860067/129608665-ca4698e8-c476-4bc8-8479-76bd459eea13.png)

Κωδικός ανέπαφης πιστωτικής

![image](https://user-images.githubusercontent.com/17860067/129608702-1a2d5212-8243-41ff-a3da-b032cffb6bd5.png)
![image](https://user-images.githubusercontent.com/17860067/129608709-8de12cce-451f-488a-b3c6-d068b461605b.png)


### Πειράματα επάνω στις τραπεζικές κάρτες

Εκτός από το rfid reader σε συνδιασμό με το Arduino υπάρχει η δυνατότητα ο
επιτιθέμενος να αγοράσει ολοκληρωμένο μηχάνημα το οποίο απλά συνδέεται σε θύρα
usb και λειτουργεί χωρίς κάποιο πρόγραμμα.

![image](https://user-images.githubusercontent.com/17860067/129608754-d47aefb7-c1e8-4083-899c-9394a185e214.png)

Αφού συνδέσουμε το μηχάνημα στην θύρα usb αρκεί να ανοίξουμε ένα text editor σε
οποιοδήποτε λογισμικό και μας εμφανίζει τις αναγκαίες πληροφορίες. Υπάρχει η
δυνατότητα αγοράς εξειδικευμένου προγράμματος από το dark web το οποίο μας
επιτρέπει με αυτό το μηχάνημα όχι μόνο να διαβάζουμε αλλά και να γράφουμε
πληροφορία.
Το μηχάνημα αυτό έχει 3 διαφορετικές λειτουργίες:

1. Contactless reader (rfid)
2. Διάβασμα του chip της κάρτας
3. Magnetic stripe reader

Πραγματοποιήσαμε scanning 4 διαφορετικών καρτών. Η πρώτη κάρτα είναι το
ATH.ENA TICKET το οποίο μέσω rfid μπορούμε να δούμε τον κωδικό του. Η δεύτερη
είναι μια κλασσική πλαστική κάρτα όπως αυτές των ξενοδοχείων για την είσοδο στο
δωμάτιο ή εταιριών για πρόσβαση σε συγκεκριμένους χώρους. Η τρίτη κάρτα είναι μία
παλιά πιστωτική που δεν έχει την δυνατότητα contactless payment και η τέταρτη επίσης
μία πιστωτική που έχει την δυνατότητα contactless payment. Όπως δείχνουμε και
παρακάτω στις πρώτες 2 κάρτες και στην πιστωτική με το contactless υπάρχει ένας
απλός κωδικός που αν αντιγραφεί είναι αρκετός για αυθεντικοποίηση. Επομένως, ένας
επιτιθέμενος έχει την δυνατότητα να υποκλέψει τον κωδικό και να αποκτήσει
πρόσβαση ή να πραγματοποιήσει συναλλαγή αποκλειστικά από αυτά τα στοιχεία.
Αυτός είναι και ο λόγος που τα contactless payments έχουν όριο ανά συναλλαγή. Όσον
αφορά το magnetic stripe μπορούμε να δούμε πως περιέχονται σχεδόν όλες οι
αναγκαίες πληροφορίες. Πιο συγκεκριμένα, περιέχονται με την σειρά ο αριθμός της
κάρτας, το όνομα του ιδιοκτήτη (σε άλλες περιπτώσεις εμφανίζεται μόνο το όνομα της
τράπεζας), η ημερομηνία λήξης της κάρτας (YY/MM) κάποιες πληροφορίες που δεν
μας χρειάζονται και μετά από τα ?; ο πίσω κωδικός της κάρτας εκτός από τα τελευταία
3 ψηφία του.

Εκτός αυτών, βρήκαμε και πρόγραμμα το οποίο αποδείχτηκε να έχει malware
επομένως δεν καταφέραμε κάνουμε proof of concept για την αντιγραφή των δεδομένων
αυτών.

Συνολικά είδαμε πως η πληροφορία είναι εύκολο να διαβαστεί, όμως στην περίπτωση
των πιστωτικών/χρεωστικών καρτών έχουν παρθεί ορισμένα μέτρα προκειμένου να
γίνεται πιο δύσκολη η ολική κλοπή καρτών. Εαν κάποιος επιθυμεί να πραγματοποιήσει
ηλεκτρονική συναλλαγή του ζητήται και ο τελευταίος 3ψηφιος κωδικός ενώ πολλές
φορές υπάρχει και2factor authentication μέσω κινητού ή εφαρμογής. Στην συναλλαγή
σε POS ή ATM χρειάζεται και το pin του χρήστη για την αξιοποίηση της κάρτας. Τέλος
για τα contactless payments δεν υπάρχει κάποιος τρόπος για να μην πραγματοποιηθεί
η συναλλαγή, όμως για την καθημερινή χρήση μικρών ποσών θεωρείται αμελητέος ο
κίνδυνος και ορίζεται το όριο στο ποσό που επιθυμεί ο κάθε χρήστης ανά συναλλαγή
χωρίς pin. Επιπλέον, ορισμένες κάρτες επιθυμούν pin ανά ορισμένο αριθμό ανέπαφων
συναλλαγών.


## Βιβλιογραφία

1. Universal Radio Hacker - Replay Attack With HackRF
    https://www.youtube.com/watch?v=uIVBVd6yi_A
2. Transmitting With A HackRF One Via My Local Ham Radio Repeater
    https://www.youtube.com/watch?v=qx_orXHiQk8
3. I Hacked Into My Own Car
    https://www.youtube.com/watch?v=5CsD8I396wo
4. Radio Hacking: Cars, Hardware, and more! - Samy Kamkar - AppSec California
    2016
    https://www.youtube.com/watch?v=1RipwqJG50c
5. Unlocking Car Doors with the HackRF Replay Attack
    https://www.youtube.com/watch?v=CA3XnGyD-SQ
6. Credit card cloning is too easy!
    https://www.youtube.com/watch?v=eyd24FlJCFg
7. Security Access using MFRC522 RFID Reader with Arduino
    https://randomnerdtutorials.com/security-access-using-mfrc522-rfid-reader-
    with-arduino/
8. What is RFID? How It Works? Interface RC522 RFID Module with Arduino
    https://lastminuteengineers.com/how-rfid-works-rc522-arduino-tutorial/


